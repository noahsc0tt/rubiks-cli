#!/usr/bin/env ruby
require 'optparse'
require 'rubiks_cli'

options = {
  scramble: false,
  time: false,
  loop: true,
  clear: false,
  wipe: false,
}
OptionParser.new do |opts|
  opts.banner = "Usage: rubiks [options]"

  opts.on("-s", "--scramble", "Generate scramble") do
    options[:scramble] = true
  end

  opts.on("-t", "--time", "Start timer") do
    options[:time] = true
  end

  opts.on("-l", "--loop", "Loop forever (default)") do
    options[:loop] = true
  end

  opts.on("-w", "--wipe", "Wipe output each loop iteration") do
    options[:wipe] = true
  end

  opts.on("-c", "--clear", "Clear the screen before starting (default for --loop)") do
    options[:clear] = true
  end
end.parse!

if options[:clear]
  RubiksCli::Clear.screen
end

if options[:scramble] && options[:time]
  RubiksCli::Solve.solve
elsif options[:scramble]
  puts RubiksCli::Scrambler.get_scramble
elsif options[:time]
  RubiksCli::Timer.time
else
  RubiksCli::Clear.screen
  RubiksCli::Solve.loop(options[:wipe])
end
